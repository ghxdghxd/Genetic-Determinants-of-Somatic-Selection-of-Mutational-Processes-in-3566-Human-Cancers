axis.text.x = element_text(size=12),
panel.grid = element_blank(),
panel.spacing = unit(0.1,"lines"),
plot.margin = margin(0,0,0,0,"lines"))
return(p)
}
plot_feature_adjR2("MP1", feature_index = c("fusion", "large", "trun", "miss", "methy","snv", "scna")) + tt
plot_feature_adjR2("MP1", feature_index = c("fusion", "large", "trun", "miss", "methy","snv", "scna"))
plot_feature_adjR2("MP1", feature_index = c("fusion", "large", "trun", "miss", "methy","snv", "scna")) + theme(strip.text.y = element_text(angle = 90))
plot_feature_adjR2("MP1", feature_index = c("fusion", "large", "trun", "miss", "methy","snv", "scna")) + theme(strip.text.y = element_text(angle = 0))
plot_feature_adjR2("MP1", feature_index = c("fusion", "large", "trun", "miss", "methy","snv", "scna")) + theme(strip.text.y = element_text(angle = 0, hjust = -2))
plot_feature_adjR2("MP1", feature_index = c("fusion", "large", "trun", "miss", "methy","snv", "scna")) + theme(strip.text.y = element_text(angle = 0, hjust = 1-1))
plot_feature_adjR2("MP1", feature_index = c("fusion", "large", "trun", "miss", "methy","snv", "scna")) + theme(strip.text.y = element_text(angle = 0, hjust = 10))
plot_feature_adjR2("MP1", feature_index = c("fusion", "large", "trun", "miss", "methy","snv", "scna")) + theme(strip.text.y = element_text(angle = 0))
plot_feature_adjR2("MP1", feature_index = c("fusion", "large", "trun", "miss", "methy","snv", "scna")) + theme(strip.text.y = element_text(angle = 0, size = 12))
plot_feature_adjR2("MP1", feature_index = c("fusion", "large", "trun", "miss", "methy","snv", "scna")) + theme(strip.text.y = element_text(angle = 0, size = 14))
plot_feature_adjR2("MP1", feature_index = c("fusion", "large", "trun", "miss", "methy","snv", "scna"))
plot_feature_adjR2 = function(signature, feature_index){
colors = pal_nejm("default")(7)
names(colors) = c("snv","scna","methy","miss","trun","large", "fusion")
features = c("Germline_missenses", "Germline_truncation", "Germline_structural", "Somatic_nsy-mutation", "SCNAs", "TSS-methylation", "Fusion")
names(features) = c("miss", "trun", "large", "snv", "scna", "methy", "fusion")
p = ggplot(mat_gs_split_FDR %>% filter(sig == signature) %>% mutate(feature=factor(feature, levels = rev(feature_index)))) +
geom_histogram(aes(x = adjr2, y = ..count.., fill = feature), position = "identity", binwidth = 0.001) +
labs(x="adjusted Rsquare", y = "", fill="Gene statuses", colour="") +
facet_grid(sig~.) + theme_article() +
scale_y_sqrt(expand = c(-0.01, 0), limits = c(0, 2300)) +
scale_x_continuous(expand = c(-0.01, 0), limits = c(-0.004, 0.541)) +
scale_fill_manual(breaks = feature_index, values = colors[feature_index], labels = features[feature_index]) +
theme(legend.position = "right",
legend.key.size = unit(0.5, 'cm'),
legend.text = element_text(size=12),
#   strip.text.y.left = element_text(angle = 0, hjust = 1, vjust = 0.5),
strip.text.y = element_text(angle = 0, size = 14),
strip.background = element_blank(),
axis.title = element_text(size=14),
axis.text.x = element_text(size=12),
panel.grid = element_blank(),
panel.spacing = unit(0.1,"lines"),
plot.margin = margin(0,0,0,0,"lines"))
return(p)
}
plot_feature_adjR2("MP1", feature_index = c("fusion", "large", "trun", "miss", "methy","snv", "scna"))
plot_feature_adjR2("MP1", feature_index = c("fusion", "large", "trun", "miss", "methy","snv", "scna"))
plot_grid(plot_feature_adjR2("MP1", feature_index = c("fusion", "large", "trun", "miss", "methy","snv", "scna")) + tt,
plot_feature_adjR2("MP2", feature_index = c("fusion", "large", "trun", "miss", "snv", "scna", "methy")) + tt,
plot_feature_adjR2("MP3", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + tt,
plot_feature_adjR2("MP4", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + tt,
plot_feature_adjR2("MP5", feature_index = c("fusion", "large", "trun", "methy","miss", "scna", "snv")) + tt,
plot_feature_adjR2("MP6", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + t,
ncol = 1, align = "hv", axis = 'rl')
t = theme(legend.position = "none",
axis.text.x = element_blank(),
axis.title.x = element_blank())
tt = t + theme(axis.ticks.x = element_blank())
plot_grid(plot_feature_adjR2("MP1", feature_index = c("fusion", "large", "trun", "miss", "methy","snv", "scna")) + tt,
plot_feature_adjR2("MP2", feature_index = c("fusion", "large", "trun", "miss", "snv", "scna", "methy")) + tt,
plot_feature_adjR2("MP3", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + tt,
plot_feature_adjR2("MP4", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + tt,
plot_feature_adjR2("MP5", feature_index = c("fusion", "large", "trun", "methy","miss", "scna", "snv")) + tt,
plot_feature_adjR2("MP6", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + t,
ncol = 1, align = "hv", axis = 'rl')
plot_feature_adjR2("MP6", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + t
plot_feature_adjR2("MP6", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv"))
tt
t
t = theme(legend.position = "none",
axis.text.x = element_blank(),
axis.title.x = element_blank())
tt = t + theme(axis.ticks.x = element_blank())
plot_feature_adjR2("MP6", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + t
plot_feature_adjR2("MP6", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv"))
plot_grid(plot_feature_adjR2("MP1", feature_index = c("fusion", "large", "trun", "miss", "methy","snv", "scna")) + tt,
plot_feature_adjR2("MP2", feature_index = c("fusion", "large", "trun", "miss", "snv", "scna", "methy")) + tt,
plot_feature_adjR2("MP3", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + tt,
plot_feature_adjR2("MP4", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + tt,
plot_feature_adjR2("MP5", feature_index = c("fusion", "large", "trun", "methy","miss", "scna", "snv")) + tt,
plot_feature_adjR2("MP6", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")),
ncol = 1, align = "hv", axis = 'rl')
pdf("Figure3A.pdf", width = 10, height = 4)
plot_grid(plot_feature_adjR2("MP1", feature_index = c("fusion", "large", "trun", "miss", "methy","snv", "scna")) + t,
plot_feature_adjR2("MP2", feature_index = c("fusion", "large", "trun", "miss", "snv", "scna", "methy")) + t,
plot_feature_adjR2("MP3", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + t,
plot_feature_adjR2("MP4", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + t,
plot_feature_adjR2("MP5", feature_index = c("fusion", "large", "trun", "methy","miss", "scna", "snv")) + t,
plot_feature_adjR2("MP6", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")),
ncol = 1, align = "hv", axis = 'rl')
dev.off()
t = theme(legend.position = "none")
pdf("Figure3A.pdf", width = 10, height = 8)
plot_grid(plot_feature_adjR2("MP1", feature_index = c("fusion", "large", "trun", "miss", "methy","snv", "scna")) + t,
plot_feature_adjR2("MP2", feature_index = c("fusion", "large", "trun", "miss", "snv", "scna", "methy")) + t,
plot_feature_adjR2("MP3", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")),
plot_feature_adjR2("MP4", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + t,
plot_feature_adjR2("MP5", feature_index = c("fusion", "large", "trun", "methy","miss", "scna", "snv")) + t,
plot_feature_adjR2("MP6", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + t,
ncol = 1, align = "hv", axis = 'rl')
dev.off()
t = theme(axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.ticks.x = element_blank())
tt = theme(legend.position = "none",
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.ticks.x = element_blank())
pdf("Figure3A.pdf", width = 10, height = 8)
plot_grid(plot_feature_adjR2("MP1", feature_index = c("fusion", "large", "trun", "miss", "methy","snv", "scna")) + tt,
plot_feature_adjR2("MP2", feature_index = c("fusion", "large", "trun", "miss", "snv", "scna", "methy")) + tt,
plot_feature_adjR2("MP3", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + tt,
plot_feature_adjR2("MP4", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + tt,
plot_feature_adjR2("MP5", feature_index = c("fusion", "large", "trun", "methy","miss", "scna", "snv")) + tt,
plot_feature_adjR2("MP6", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + t,
ncol = 1, align = "hv", axis = 'rl')
dev.off()
t = theme(axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.ticks.x = element_blank())
tt = theme(legend.position = "none",
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.ticks.x = element_blank())
pdf("Figure3A.pdf", width = 10, height = 6)
plot_grid(plot_feature_adjR2("MP1", feature_index = c("fusion", "large", "trun", "miss", "methy","snv", "scna")) + tt,
plot_feature_adjR2("MP2", feature_index = c("fusion", "large", "trun", "miss", "snv", "scna", "methy")) + tt,
plot_feature_adjR2("MP3", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + tt,
plot_feature_adjR2("MP4", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + tt,
plot_feature_adjR2("MP5", feature_index = c("fusion", "large", "trun", "methy","miss", "scna", "snv")) + tt,
plot_feature_adjR2("MP6", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + t,
ncol = 1, align = "hv", axis = 'rl')
dev.off()
plot_grid(plot_feature_adjR2("MP1", feature_index = c("fusion", "large", "trun", "miss", "methy","snv", "scna")) + tt,
plot_feature_adjR2("MP2", feature_index = c("fusion", "large", "trun", "miss", "snv", "scna", "methy")) + tt,
plot_feature_adjR2("MP3", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + tt,
plot_feature_adjR2("MP4", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + tt,
plot_feature_adjR2("MP5", feature_index = c("fusion", "large", "trun", "methy","miss", "scna", "snv")) + tt,
plot_feature_adjR2("MP6", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + t + theme(legend.position = c(0,1)),
ncol = 1, align = "hv", axis = 'rl')
plot_grid(plot_feature_adjR2("MP1", feature_index = c("fusion", "large", "trun", "miss", "methy","snv", "scna")) + tt,
plot_feature_adjR2("MP2", feature_index = c("fusion", "large", "trun", "miss", "snv", "scna", "methy")) + tt,
plot_feature_adjR2("MP3", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + tt,
plot_feature_adjR2("MP4", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + tt,
plot_feature_adjR2("MP5", feature_index = c("fusion", "large", "trun", "methy","miss", "scna", "snv")) + tt,
plot_feature_adjR2("MP6", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + t + theme(legend.position = c(1,1)),
ncol = 1, align = "hv", axis = 'rl')
t2 = theme(legend.position = "none")
t = theme(legend.position = "none",
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.ticks.x = element_blank())
t1 = theme(legend.position = c(1,1),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.ticks.x = element_blank())
t2 = theme(legend.position = "none")
plot_grid(plot_feature_adjR2("MP1", feature_index = c("fusion", "large", "trun", "miss", "methy","snv", "scna")) + t,
plot_feature_adjR2("MP2", feature_index = c("fusion", "large", "trun", "miss", "snv", "scna", "methy")) + t,
plot_feature_adjR2("MP3", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + t1,
plot_feature_adjR2("MP4", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + t,
plot_feature_adjR2("MP5", feature_index = c("fusion", "large", "trun", "methy","miss", "scna", "snv")) + t,
plot_feature_adjR2("MP6", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + t2,
ncol = 1, align = "hv", axis = 'rl')
t = theme(legend.position = "none",
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.ticks.x = element_blank())
t1 = theme(legend.position = c(0.5,1),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.ticks.x = element_blank())
t2 = theme(legend.position = "none")
plot_grid(plot_feature_adjR2("MP1", feature_index = c("fusion", "large", "trun", "miss", "methy","snv", "scna")) + t,
plot_feature_adjR2("MP2", feature_index = c("fusion", "large", "trun", "miss", "snv", "scna", "methy")) + t,
plot_feature_adjR2("MP3", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + t1,
plot_feature_adjR2("MP4", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + t,
plot_feature_adjR2("MP5", feature_index = c("fusion", "large", "trun", "methy","miss", "scna", "snv")) + t,
plot_feature_adjR2("MP6", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + t2,
ncol = 1, align = "hv", axis = 'rl')
t = theme(legend.position = "none",
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.ticks.x = element_blank())
t1 = theme(legend.position = c(0.8,1),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.ticks.x = element_blank())
t2 = theme(legend.position = "none")
plot_grid(plot_feature_adjR2("MP1", feature_index = c("fusion", "large", "trun", "miss", "methy","snv", "scna")) + t,
plot_feature_adjR2("MP2", feature_index = c("fusion", "large", "trun", "miss", "snv", "scna", "methy")) + t,
plot_feature_adjR2("MP3", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + t1,
plot_feature_adjR2("MP4", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + t,
plot_feature_adjR2("MP5", feature_index = c("fusion", "large", "trun", "methy","miss", "scna", "snv")) + t,
plot_feature_adjR2("MP6", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + t2,
ncol = 1, align = "hv", axis = 'rl')
pdf("Figure3A.pdf", width = 10, height = 8)
plot_grid(plot_feature_adjR2("MP1", feature_index = c("fusion", "large", "trun", "miss", "methy","snv", "scna")) + t,
plot_feature_adjR2("MP2", feature_index = c("fusion", "large", "trun", "miss", "snv", "scna", "methy")) + t,
plot_feature_adjR2("MP3", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + t1,
plot_feature_adjR2("MP4", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + t,
plot_feature_adjR2("MP5", feature_index = c("fusion", "large", "trun", "methy","miss", "scna", "snv")) + t,
plot_feature_adjR2("MP6", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + t2,
ncol = 1, align = "hv", axis = 'rl')
dev.off()
pdf("Figure3A.pdf", width = 10, height = 6)
plot_grid(plot_feature_adjR2("MP1", feature_index = c("fusion", "large", "trun", "miss", "methy","snv", "scna")) + t,
plot_feature_adjR2("MP2", feature_index = c("fusion", "large", "trun", "miss", "snv", "scna", "methy")) + t,
plot_feature_adjR2("MP3", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + t1,
plot_feature_adjR2("MP4", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + t,
plot_feature_adjR2("MP5", feature_index = c("fusion", "large", "trun", "methy","miss", "scna", "snv")) + t,
plot_feature_adjR2("MP6", feature_index = c("fusion", "large", "trun", "miss", "methy", "scna", "snv")) + t2,
ncol = 1, align = "hv", axis = 'rl')
dev.off()
out_dir = "~/Seafile/SwapBox/21TCGA/maintext/results/12rare_fusion/"
mat_sig <- read.table(paste0(out_dir, "mat_rank_gs_split_sig.txt"), header = T, sep = "\t",
stringsAsFactors = F)
dim(mat_sig)
length(unique(mat_sig$gene))
library(ggsci)
plot_driverGene_num = function(mat){
a = as.data.frame.matrix(table(mat[,c("gene","sig")]))
a[a>0]=1
a = as.data.frame(table(rowSums(a)))
a$type = "Signature"
b = as.data.frame.matrix(table(mat[,c("gene","cancer")]))
b[b>0]=1
bb = as.data.frame(table(rowSums(b[,-5])))
bb$type = "Cancer"
bb$Freq[bb$Var1==0] = as.data.frame(table(b$panCan))[2, 2]
dat = rbind(data.frame(Var1=NA, Freq=2314,type="bg"), a, bb)
dat$Var1 = gsub("0","pan-Cancer",dat$Var1)
dat$Var1[dat$Var1!="pan-Cancer" & dat$type == "Cancer"] = "Cancer-specific"
dat$Var1 = factor(dat$Var1, levels = c(1:4,"pan-Cancer","Cancer-specific"))
d3 = pal_d3("category10")(10)
p = ggplot(na.omit(dat), aes(x=Var1, y=Freq)) + geom_bar(stat = "identity") +
facet_wrap(~type, scale="free") + theme_bw() +
labs(x = "", y = "Gene count") +
theme(axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
strip.text = element_text(size =12),
legend.position = "none")
return(p)
}
p_driverGene_num = plot_driverGene_num(mat_sig)
p_driverGene_num
plot_driverGene_num = function(mat){
a = as.data.frame.matrix(table(mat[,c("gene","sig")]))
a[a>0]=1
a = as.data.frame(table(rowSums(a)))
a$type = "Signature"
b = as.data.frame.matrix(table(mat[,c("gene","cancer")]))
b[b>0]=1
bb = as.data.frame(table(rowSums(b[,-5])))
bb$type = "Cancer"
bb$Freq[bb$Var1==0] = as.data.frame(table(b$panCan))[2, 2]
dat = rbind(data.frame(Var1=NA, Freq=2314,type="bg"), a, bb)
dat$Var1 = gsub("0","pan-Cancer",dat$Var1)
dat$Var1[dat$Var1!="pan-Cancer" & dat$type == "Cancer"] = "Cancer-specific"
dat$Var1 = factor(dat$Var1, levels = c(1:4,"pan-Cancer","Cancer-specific"))
d3 = pal_d3("category10")(10)
p = ggplot(na.omit(dat), aes(x=Var1, y=Freq)) + geom_bar(stat = "identity") +
facet_wrap(type~, scale="free") + theme_bw() +
labs(x = "", y = "Gene count") +
theme(axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
strip.text = element_text(size =12),
legend.position = "none")
return(p)
}
plot_driverGene_num = function(mat){
a = as.data.frame.matrix(table(mat[,c("gene","sig")]))
a[a>0]=1
a = as.data.frame(table(rowSums(a)))
a$type = "Signature"
b = as.data.frame.matrix(table(mat[,c("gene","cancer")]))
b[b>0]=1
bb = as.data.frame(table(rowSums(b[,-5])))
bb$type = "Cancer"
bb$Freq[bb$Var1==0] = as.data.frame(table(b$panCan))[2, 2]
dat = rbind(data.frame(Var1=NA, Freq=2314,type="bg"), a, bb)
dat$Var1 = gsub("0","pan-Cancer",dat$Var1)
dat$Var1[dat$Var1!="pan-Cancer" & dat$type == "Cancer"] = "Cancer-specific"
dat$Var1 = factor(dat$Var1, levels = c(1:4,"pan-Cancer","Cancer-specific"))
d3 = pal_d3("category10")(10)
p = ggplot(na.omit(dat), aes(x=Var1, y=Freq)) + geom_bar(stat = "identity") +
facet_wrap(type~., scale="free") + theme_bw() +
labs(x = "", y = "Gene count") +
theme(axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
strip.text = element_text(size =12),
legend.position = "none")
return(p)
}
p_driverGene_num = plot_driverGene_num(mat_sig)
p_driverGene_num
p_driverGene_num
plot_driverGene_num = function(mat){
a = as.data.frame.matrix(table(mat[,c("gene","sig")]))
a[a>0]=1
a = as.data.frame(table(rowSums(a)))
a$type = "Signature"
b = as.data.frame.matrix(table(mat[,c("gene","cancer")]))
b[b>0]=1
bb = as.data.frame(table(rowSums(b[,-5])))
bb$type = "Cancer"
bb$Freq[bb$Var1==0] = as.data.frame(table(b$panCan))[2, 2]
dat = rbind(data.frame(Var1=NA, Freq=2314,type="bg"), a, bb)
dat$Var1 = gsub("0","pan-Cancer",dat$Var1)
dat$Var1[dat$Var1!="pan-Cancer" & dat$type == "Cancer"] = "Cancer-specific"
dat$Var1 = factor(dat$Var1, levels = c(1:4,"pan-Cancer","Cancer-specific"))
d3 = pal_d3("category10")(10)
p = ggplot(na.omit(dat), aes(x=Var1, y=Freq)) + geom_bar(stat = "identity") +
facet_grid(type~., scale="free") + theme_bw() +
labs(x = "", y = "Gene count") +
theme(axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
strip.text = element_text(size =12),
legend.position = "none")
return(p)
}
plot_driverGene_num(mat_sig)
plot_driverGene_num = function(mat){
a = as.data.frame.matrix(table(mat[,c("gene","sig")]))
a[a>0]=1
a = as.data.frame(table(rowSums(a)))
a$type = "Signature"
b = as.data.frame.matrix(table(mat[,c("gene","cancer")]))
b[b>0]=1
bb = as.data.frame(table(rowSums(b[,-5])))
bb$type = "Cancer"
bb$Freq[bb$Var1==0] = as.data.frame(table(b$panCan))[2, 2]
dat = rbind(data.frame(Var1=NA, Freq=2314,type="bg"), a, bb)
dat$Var1 = gsub("0","pan-Cancer",dat$Var1)
dat$Var1[dat$Var1!="pan-Cancer" & dat$type == "Cancer"] = "Cancer-specific"
dat$Var1 = factor(dat$Var1, levels = c(1:4,"pan-Cancer","Cancer-specific"))
d3 = pal_d3("category10")(10)
p = ggplot(na.omit(dat), aes(x=Var1, y=Freq)) + geom_bar(stat = "identity") +
facet_grid(type~., scale="free", space = "free") + theme_bw() +
labs(x = "", y = "Gene count") +
theme(axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
strip.text = element_text(size =12),
legend.position = "none")
return(p)
}
plot_driverGene_num(mat_sig)
plot_driverGene_num = function(mat){
a = as.data.frame.matrix(table(mat[,c("gene","sig")]))
a[a>0]=1
a = as.data.frame(table(rowSums(a)))
a$type = "Signature"
b = as.data.frame.matrix(table(mat[,c("gene","cancer")]))
b[b>0]=1
bb = as.data.frame(table(rowSums(b[,-5])))
bb$type = "Cancer"
bb$Freq[bb$Var1==0] = as.data.frame(table(b$panCan))[2, 2]
dat = rbind(data.frame(Var1=NA, Freq=2314,type="bg"), a, bb)
dat$Var1 = gsub("0","pan-Cancer",dat$Var1)
dat$Var1[dat$Var1!="pan-Cancer" & dat$type == "Cancer"] = "Cancer-specific"
dat$Var1 = factor(dat$Var1, levels = c(1:4,"pan-Cancer","Cancer-specific"))
d3 = pal_d3("category10")(10)
p = ggplot(na.omit(dat), aes(x=Var1, y=Freq)) + geom_bar(stat = "identity") +
facet_wrap(type~., scale="free") + theme_bw() +
labs(x = "", y = "Gene count") +
theme(axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
strip.text = element_text(size =12),
legend.position = "none")
return(p)
}
plot_driverGene_num(mat_sig)
pdf("Figure3C_D.pdf", width = 5, height = 3)
p_driverGene_num
dev.off()
theme(plot_driverGene_num = function(mat){
a = as.data.frame.matrix(table(mat[,c("gene","sig")]))
a[a>0]=1
a = as.data.frame(table(rowSums(a)))
a$type = "Signature"
b = as.data.frame.matrix(table(mat[,c("gene","cancer")]))
b[b>0]=1
bb = as.data.frame(table(rowSums(b[,-5])))
bb$type = "Cancer"
bb$Freq[bb$Var1==0] = as.data.frame(table(b$panCan))[2, 2]
dat = rbind(data.frame(Var1=NA, Freq=2314,type="bg"), a, bb)
dat$Var1 = gsub("0","pan-Cancer",dat$Var1)
dat$Var1[dat$Var1!="pan-Cancer" & dat$type == "Cancer"] = "Cancer-specific"
dat$Var1 = factor(dat$Var1, levels = c(1:4,"pan-Cancer","Cancer-specific"))
d3 = pal_d3("category10")(10)
p = ggplot(na.omit(dat), aes(x=Var1, y=Freq)) + geom_bar(stat = "identity") +
facet_wrap(type~., scale="free") + theme_bw() +
labs(x = "", y = "Gene count") +
theme(axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
strip.text = element_text(size =12),
legend.position = "none",
aspect.ratio = 1)
return(p)
}
p_driverGene_num = plot_driverGene_num(mat_sig) = )
plot_driverGene_num = function(mat){
a = as.data.frame.matrix(table(mat[,c("gene","sig")]))
a[a>0]=1
a = as.data.frame(table(rowSums(a)))
a$type = "Signature"
b = as.data.frame.matrix(table(mat[,c("gene","cancer")]))
b[b>0]=1
bb = as.data.frame(table(rowSums(b[,-5])))
bb$type = "Cancer"
bb$Freq[bb$Var1==0] = as.data.frame(table(b$panCan))[2, 2]
dat = rbind(data.frame(Var1=NA, Freq=2314,type="bg"), a, bb)
dat$Var1 = gsub("0","pan-Cancer",dat$Var1)
dat$Var1[dat$Var1!="pan-Cancer" & dat$type == "Cancer"] = "Cancer-specific"
dat$Var1 = factor(dat$Var1, levels = c(1:4,"pan-Cancer","Cancer-specific"))
d3 = pal_d3("category10")(10)
p = ggplot(na.omit(dat), aes(x=Var1, y=Freq)) + geom_bar(stat = "identity") +
facet_wrap(type~., scale="free") + theme_bw() +
labs(x = "", y = "Gene count") +
theme(axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
strip.text = element_text(size =12),
legend.position = "none",
aspect.ratio = 1)
return(p)
}
p_driverGene_num = plot_driverGene_num(mat_sig)
pdf("Figure3C_D.pdf", width = 6, height = 3)
p_driverGene_num
dev.off()
pdf("Figure3C_D.pdf", width = 8, height = 4)
p_driverGene_num
dev.off()
plot_driverGene_num = function(mat){
a = as.data.frame.matrix(table(mat[,c("gene","sig")]))
a[a>0]=1
a = as.data.frame(table(rowSums(a)))
a$type = "Signature"
b = as.data.frame.matrix(table(mat[,c("gene","cancer")]))
b[b>0]=1
bb = as.data.frame(table(rowSums(b[,-5])))
bb$type = "Cancer"
bb$Freq[bb$Var1==0] = as.data.frame(table(b$panCan))[2, 2]
dat = rbind(data.frame(Var1=NA, Freq=2314,type="bg"), a, bb)
dat$Var1 = gsub("0","pan-Cancer",dat$Var1)
dat$Var1[dat$Var1!="pan-Cancer" & dat$type == "Cancer"] = "Cancer-specific"
dat$Var1 = factor(dat$Var1, levels = c(1:4,"pan-Cancer","Cancer-specific"))
d3 = pal_d3("category10")(10)
p = ggplot(na.omit(dat), aes(x=Var1, y=Freq)) + geom_bar(stat = "identity", width = 0.5) +
facet_wrap(type~., scale="free") + theme_bw() +
labs(x = "", y = "Gene count") +
theme(axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
strip.text = element_text(size =12),
legend.position = "none",
aspect.ratio = 1)
return(p)
}
plot_driverGene_num(mat_sig)
plot_driverGene_num = function(mat){
a = as.data.frame.matrix(table(mat[,c("gene","sig")]))
a[a>0]=1
a = as.data.frame(table(rowSums(a)))
a$type = "Signature"
b = as.data.frame.matrix(table(mat[,c("gene","cancer")]))
b[b>0]=1
bb = as.data.frame(table(rowSums(b[,-5])))
bb$type = "Cancer"
bb$Freq[bb$Var1==0] = as.data.frame(table(b$panCan))[2, 2]
dat = rbind(data.frame(Var1=NA, Freq=2314,type="bg"), a, bb)
dat$Var1 = gsub("0","pan-Cancer",dat$Var1)
dat$Var1[dat$Var1!="pan-Cancer" & dat$type == "Cancer"] = "Cancer-specific"
dat$Var1 = factor(dat$Var1, levels = c(1:4,"pan-Cancer","Cancer-specific"))
d3 = pal_d3("category10")(10)
p = ggplot(na.omit(dat), aes(x=Var1, y=Freq)) + geom_bar(stat = "identity", width = 0.3) +
facet_wrap(type~., scale="free") + theme_bw() +
labs(x = "", y = "Gene count") +
theme(axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
strip.text = element_text(size =12),
legend.position = "none",
aspect.ratio = 1)
return(p)
}
plot_driverGene_num(mat_sig)
plot_driverGene_num = function(mat){
a = as.data.frame.matrix(table(mat[,c("gene","sig")]))
a[a>0]=1
a = as.data.frame(table(rowSums(a)))
a$type = "Signature"
b = as.data.frame.matrix(table(mat[,c("gene","cancer")]))
b[b>0]=1
bb = as.data.frame(table(rowSums(b[,-5])))
bb$type = "Cancer"
bb$Freq[bb$Var1==0] = as.data.frame(table(b$panCan))[2, 2]
dat = rbind(data.frame(Var1=NA, Freq=2314,type="bg"), a, bb)
dat$Var1 = gsub("0","pan-Cancer",dat$Var1)
dat$Var1[dat$Var1!="pan-Cancer" & dat$type == "Cancer"] = "Cancer-specific"
dat$Var1 = factor(dat$Var1, levels = c(1:4,"pan-Cancer","Cancer-specific"))
d3 = pal_d3("category10")(10)
p = ggplot(na.omit(dat), aes(x=Var1, y=Freq)) + geom_bar(stat = "identity", width = 0.5) +
facet_wrap(type~., scale="free") + theme_bw() +
labs(x = "", y = "Gene count") +
theme(axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
strip.text = element_text(size =12),
legend.position = "none",
aspect.ratio = 1)
return(p)
}
p_driverGene_num = plot_driverGene_num(mat_sig)
pdf("Figure3C_D.pdf", width = 8, height = 4)
p_driverGene_num
dev.off()
dim(mat_gs_split_FDR)
